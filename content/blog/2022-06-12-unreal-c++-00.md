---
title: "2022 06 12 Unreal C++ 00"
date: 2022-06-12T00:00:00+09:00
archives:
    - 2022-06
categories: ["blog"]
tags: ["note", "unreal", "C++"]
draft: true
---

# はじめに

# 文字コード
結論から"BOM付きUTF-8"一択です. この問題はコンパイラが関係しています.  
旧くはmsvcとその他のコンパイラでソースコードの文字コードを統一することが難しかったのですが, 今はコンパイラの改善でそれほど難しくありません.  
しかし, Unreal Engineが挟まることでこの問題が再燃します.

Unreal Engineにおける各コンパイラについて簡単にまとめますと,

- Clang
  - Windows系以外で使用されます.
- MSVC
  - Windows系に使用されます, XBoxもWindowsです.
  - Clangに変更することはできますが, エンジン自身に警告が残っているため実質使用できません.
    - ちなみに, "C:\Program Files"にClangがインストールされていないと認識しません.

それぞれの文字コードの扱いと, Unreal Engineの設定は次のようになっています.
- Clang
  - ソースコードの文字コードは`-finput-charset`で指定することができます, デフォルトは`UTF-8`です. BOMにも対応しています.
  - `-finput-charset`は指定されていないためデフォルトの設定です.
- MSVC
  - BOMがない場合, `cp932`として処理します. BOMがある場合は`UTF-8`として処理します.
  - コンパイルオプション`/source-charset:utf-8`を指定すると, BOMがない場合は`UTF-8`として処理します.
    - 逆に`cp932`のソースコードがあると問題が発生することがあるということです.
  - Windowsに関しては, `/source-charset:utf-8`が指定されています.

以上から, "BOM付きUTF-8"が最も問題が起きにくいと思われます. しかし, まだ終わりません, 開発中に"BOM付きUTF-8"を強制する手段が少ないのです.
例えば, テンプレートをBOM付きにしても, Unreal EngineのC++ファイル生成は"BOMを無視してロード, 特定のキーワードを置換, 保存"ですので無意味です.  
さらに最も簡単で問題が確実に起きない解決方法は, "ASCII(Latin-1)以外は使わない"だと思います.  
解は模索中です.

文字コードとは別ですが, "Windows向けの開発しかしない"という方以外はClangぐらいは知っておいていいと思います.

# Unityビルド

